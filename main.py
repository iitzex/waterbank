from datetime import date, time, timedelta, datetime
import requests
from bs4 import BeautifulSoup
import pandas as pd

def parse(year, month, day):
    addr = 'http://fhy.wra.gov.tw/ReservoirPage_2011/Statistics.aspx'

    header = {
        'ctl00$ctl02':'ctl00$cphMain$ctl00|ctl00$cphMain$btnQuery',
        'ctl00_ctl02_HiddenField':';;AjaxControlToolkit, Version=3.0.20820.16598, Culture=neutral, PublicKeyToken=28f01b0e84b6d53e:zh-TW:707835dd-fa4b-41d1-89e7-6df5d518ffb5:411fea1c:865923e8:77c58d20:91bd373d:14b56adc:596d588c:8e72a662:acd642d2:269a19ae;;AjaxControlToolkit, Version=3.0.20820.16598, Culture=neutral, PublicKeyToken=28f01b0e84b6d53e:zh-TW:707835dd-fa4b-41d1-89e7-6df5d518ffb5:411fea1c:865923e8:77c58d20:91bd373d:14b56adc:596d588c:8e72a662:acd642d2:269a19ae',
        '__EVENTTARGET':'ctl00$cphMain$btnQuery',
        '__EVENTARGUMENT':'',
        '__VIEWSTATE':'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',
        '__VIEWSTATEGENERATOR':'3F55A216',
        '__EVENTVALIDATION':'/wEWfwKGmaWyAQLtxL+0DQLzwseGDQLlt4rKCwLlt5aXAgLlt6KwCQLlt87cAQLlt9r5CALlt+aCBwLlt/KvDgLlt57IBgLlt+ojAuW39swIAtLdyosCAtLd1tQKAtLd4vEBAtLdjpoIAtLdmqcHAtLdpsAPAtLdsu0GAtLd3okNAtLdquEIAtLdtooHAu/0qKUEAu/0tM4MAu/0wOoLAu/07LcCAu/0+NAKAu/0hP0BAu/0kIYIAu/0vKMHAu/0iJoCAu/0lKcJAquX/dEMAquXifoLAquXlYcCAquXoaAJAquXzcwBAquX2ekIAquX5bIHAquX8d8PAquX3bYJAquX6dMBAsCu28oGAsCu55cNAsCu87AEAsCun90MAsCuq+YLAsCut4MCAsCuw68JAsCu78gBAsCuu6ADAqWQjIEPAqSQjIEPAqeQjIEPAqaQjIEPAqGQjIEPAqCQjIEPAqOQjIEPArKQjIEPAr2QjIEPAqWQzIIPAqWQwIIPAqWQxIIPAqmAk+8BAqiAk+8BAquAk+8BAqqAk+8BAq2Ak+8BAqyAk+8BAq+Ak+8BAr6Ak+8BArGAk+8BAqmA0+wBAqmA3+wBAqmA2+wBAqmA5+wBAqmA4+wBAqmA7+wBAqmA6+wBAqmA9+wBAqmAs+8BAqmAv+8BAqiA0+wBAqiA3+wBAqiA2+wBAqiA5+wBAqiA4+wBAqiA7+wBAqiA6+wBAqiA9+wBAqiAs+8BAqiAv+8BAquA0+wBAquA3+wBAsbvrsANAtnvrsANAtjvrsANAtvvrsANAtrvrsANAt3vrsANAtzvrsANAt/vrsANAs7vrsANAsHvrsANAtnv7sMNAtnv4sMNAtnv5sMNAtnv2sMNAtnv3sMNAtnv0sMNAtnv1sMNAtnvysMNAtnvjsANAtnvgsANAtjv7sMNAtjv4sMNAtjv5sMNAtjv2sMNAraQhCMCqZDEIAKokMQgAquQxCACqpDEIAKtkMQgAru47o8LAv38uJEOHaBH5l6jMeoauMLlYdV7FuWsY5U=',
        'ctl00$cphMain$cboSearch':'防汛重點水庫',
        'ctl00$cphMain$ucDate$cboYear': year,
        'ctl00$cphMain$ucDate$cboMonth': month,
        'ctl00$cphMain$ucDate$cboDay': day,
        'ctl00$cphMain$ucDate$cboHour':'0',
        'ctl00$cphMain$ucDate$cboMinute':'0',
        '__ASYNCPOST':'false'
    }

    r = requests.post(addr, data=header)
    soup = BeautifulSoup(r.text, "html.parser")

    columns = [
        '水庫名稱', '水情時間', '本日集水區累積降雨量', '進流量', '水位', '滿水位', '有效蓄水量', '蓄水', '取水流量', '發電放水口', '排砂道',
        '排洪隧道', '溢洪道', '小計', '目前狀態', '預定時間', '預定放流量'
    ]
    df = pd.read_html(r.text, skiprows=4)[0]
    df.columns = columns
    df.set_index('水庫名稱', inplace=True)
    df.drop(['附註'], inplace=True)

    df.to_csv('csv/{}_{}_{}.csv'.format(year, month, day))

    writer = pd.ExcelWriter('xlsx/{}_{}_{}.xlsx'.format(year, month, day))
    df.to_excel(writer,'Sheet1')
    writer.save()


def timeseries():
    d = date(2017, 6, 1)
    t = time(0, 0)
    begin = datetime.combine(d, t)
    today = datetime.today()

    while begin < today:
        yield begin
        begin += timedelta(1)


if __name__ == '__main__':
    for t in timeseries():
        print('processing', t.year, t.month, t.day)
        parse(t.year, t.month, t.day)
